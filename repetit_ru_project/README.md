# Построение ML-продукта для выявления и оптимизации платежей преподавателей сервиса Repetit.ru

## Задача 

Разработать модель, которая по имеющейся информации о репетиторе и проведенных им занятий будет классифицировать репетиторов на платящих и неэффективных. 

Оценка качества модели будет производиться с использованием метрики `F1`.

## В данном проекте были реализованы следующие этапы работ:

1. Загружены данные:

- `Информация о репетиторах (teacher_info.feather)`;
- `Статистика по репетиторам и таргет (teachers.feather)`;
- `Ученики (lesson_course.feather)`;
- `Занятия (lessons.feather)`;
- `Цены на занятия репетиторов (teacher_prices.feather)`;
- `Заявки (orders.feather)`

2. Объединены данные в общую таблицу по столбцу.
3. Проведена предобработка данных:

- запонение пропусков после объединения таблиц;
- проверка на наличие дубликатов;
- изменение типа данных для корректного дальнейшего исследования;
- добавление новых признаков.

4. Проведен исследовательский анализ данных.

5. Подготовка данных для построения модели.

6. Построение моделей, подбор гиперпараметров и оценка их качества:

- Были построены следующие модели:
  - Логистическая регрессия (`LogisticRegression`)
  - Случайный лес (`RandomForestClassifier`)
  - `CatBoostClassifier`

- оценка качества модели проходила на метрике F1.

7. Выбор и тестирование наилучшей по качеству модели.
8. Построение матрицы ошибок и диаграммы важности признаков.
9. Формирование выводов по итогам проекта.

## Используемые библиотеки

- pandas
- numpy
- matplotlib
- seaborn
- pyarrow
- datetime
- phik
- sklearn
- catboost

## Итог проекта

В данном проекте были отработаны такие навыки как:

- Объединение данных в общую таблицу
- Проведение первичной EDA
- Оценка дисбаланса класса в задаче классификации
- Рассмотрена корреляция признаков. Построена матрица корреляции с помощью метода Phik
- Кодирование и масштабирование признаков
- Подбор гиперпараметров и получение лучшей модели для тестов
- Построение и анализ матрицы ошибок
- Построение диаграммы важности признаков
- Общий отчет по итогам исследования для заказчика